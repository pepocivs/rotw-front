<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/wild-main/wild-main.html">
<link rel="import" href="../../bower_components/iron-icons/maps-icons.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/dom-repeat-n/dom-repeat-n.html">

<link rel="import" href="general-style.html">

<dom-module id="my-recipes">
    <template>
      <style include="general-style iron-flex iron-flex-alignment">
        :host {
            display: block;
          }
          span.title{
            margin-left: 15px !important;
          }
      </style>
      <iron-ajax auto
      url="http://zelda.pepocivs.com/recipes"
      params='{}'
      handle-as="json"
      last-response="{{recipesResponse}}"></iron-ajax>

      <div class="info-black layout horizontal wrap center around-justified">
        <iron-icon src="/images/pira.svg"></iron-icon>
        <span class="flex ">1 receta</span>
        <iron-icon  icon="icons:search"></iron-icon>
      </div>

      <div class="layout horizontal wrap center-center"style="background-color: white;">

        <template is="dom-repeat" items="[[recipeList]]">

            <!--
            <div class="food-box layout horizontal nowrap center-center justified" >

            <div  style="width: 24%;margin-right: 9px;">
                <img src="{{item.image}}" alt="" class="foodprincipal">
            </div>
            <div class="food-box-one flex three  self-start">
                <p>{{item.name}}</p>
                <template is="dom-repeat" items="[[item.effects]]" as="effect">
                  <img src="{{effect.icon}}" alt=""class="img-efects">
                </template>
            </div>
            <div class="v"></div>
              <div class="flex one food-box-two  self-start">
                <template is="dom-repeat" items="[[item.ingredients]]" as="ingredient">
                  <img src="{{ingredient.image}}" alt=""class="img-ingredients">
                </template>
                <iron-icon  icon="icons:star-border"></iron-icon>
              </div>
            </div>
          -->
            <div class="food-box-form layout horizontal nowrap center-center justified" >
              <div  style="width: 24%;margin-right: 9px;">
                <img src="{{item.image}}" alt="{{item.name}}" class="foodprincipal">
              </div>
              <div class="food-box-one flex three wrap  self-start">
                <p>{{item.name}}</p>
                <div class="flex wrapText grey">{{item.description}}</div>
                <template is="dom-repeat" items="{{item.effectsToPrint}}" as="effect" index-as="x">
                    <img src="{{effect.icon}}" value="{{effect._id}}" alt="" class="img-efects">
                </template>
              </div>
              <div class="v"></div>
              <div class="flex one food-box-two  self-start">
                <template is="dom-repeat" items="{{item.ingredients}}" as="ingredient" index-as="x">
                  <template is="dom-repeat-n" count="{{ingredient.howMany}}">
                    <img src="{{ingredient.image}}" value="{{ingredient._id}}" alt="" class="img-ingredients" />
                  </template>
                </template>
                <iron-icon src="{{item.craftingIcon}}"></iron-icon>
              </div>
            </div>

        </template>
      </div>
    </template>

    <script>
        Polymer({
            is: 'my-recipes',

            properties: {
              inventory: {
                type: Object
              },
              recipesResponse: {
                type: Object,
                observer: '_recipesResponse'
              }
            },
            observers: [],
            _recipesResponse: function(response) {
              for (var i = 0; i < response.length; i++) {
                response[i].effectsToPrint = [];
                for (var x = 0; x < response[i].effects.length; x++) {
                  if (response[i].effects[x].icon.indexOf('/ic_heart_red.png') > 0) {
                      var n = Math.floor(response[i].effects[x].value);
                      var m = (response[i].effects[x].value - n);
                      for (var j = 0; j < n; j++ ) {
                        response[i].effectsToPrint.push({
                          "_id": response[i].effects[x]._id,
                          "name": response[i].effects[x].name,
                          "icon": response[i].effects[x].icon,
                          "value": "1"
                        });
                      }
                      if (m === 0.25) {
                        response[i].effectsToPrint.push({
                          "_id": response[i].effects[x]._id,
                          "name": response[i].effects[x].name,
                          "icon": "http://zelda.pepocivs.com/images/ic_heart_red_quarter.png",
                          "value": "1"
                        });
                      } else if (m === 0.50) {
                        response[i].effectsToPrint.push({
                          "_id": response[i].effects[x]._id,
                          "name": response[i].effects[x].name,
                          "icon": "http://zelda.pepocivs.com/images/ic_heart_red_half.png",
                          "value": "1"
                        });
                      } else if (m === 0.75) {
                        response[i].effectsToPrint.push({
                          "_id": response[i].effects[x]._id,
                          "name": response[i].effects[x].name,
                          "icon": "http://zelda.pepocivs.com/images/ic_heart_red_three_quarter.png",
                          "value": "1"
                        });
                      }
                  }
                  // response[i].effectsToPrint.push({
                  //
                  // });
                }
              }
              console.log(response);
              this.recipeList = response;
            },
        });
    </script>
</dom-module>
